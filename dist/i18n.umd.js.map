{"version":3,"file":"i18n.umd.js","sources":["../src/utils.js","../src/http.js","../src/index.js"],"sourcesContent":["import getData from './http'\n\nconst i18nTypes = ['c', 'k', 'p', 's', 'p-ph', 'c-ph', 'k-ph', 'p-i', 'c-i', 'k-i']\n\nconst setLang = lang => window.localStorage.setItem('lx011I18nLang', lang)\nconst getLang = () => window.localStorage.getItem('lx011I18nLang')\n\nconst getJSON = (uri, type, _el, _attr, i) => {\n  _el.forEach(j => {\n    if(j.getAttribute('i18n-o') === null) {\n      getData(uri, data => {\n        data = JSON.parse(data)\n        let val = j.getAttribute(_attr)\n        if(i === type) j.innerHTML = data[val]\n        if(i === `${type}-i`) j.src = data[val]\n        if(i === `${type}-ph`) j.placeholder = data[val]\n      })\n    }\n  })\n}\n\nexport {\n  i18nTypes,\n  setLang,\n  getLang,\n  getJSON,\n}","/**\n * httpRequest\n * @param {String} uri \n * @param {Function} callback \n */\nexport default function (uri, cb) {\n  var httpRequest\n  if (window.XMLHttpRequest) {\n    // Mozilla, Safari, IE7+ ...\n    httpRequest = new XMLHttpRequest()\n  } else if (window.ActiveXObject) {\n    // IE 6 and older\n    httpRequest = new ActiveXObject(\"Microsoft.XMLHTTP\")\n  }\n\n  if (!httpRequest) {\n    alert('Giving up :( Cannot create an XMLHTTP instance');\n    return false\n  }\n  httpRequest.onreadystatechange = handler\n  httpRequest.open('GET', uri)\n  httpRequest.send(null)\n\n  function handler() {\n    if(httpRequest.readyState === XMLHttpRequest.DONE) {\n      if(httpRequest.status === 200) {\n        cb(httpRequest.responseText)\n      } else {\n        console.error('There was a problem with the request.')\n      }\n    }\n  }\n}","import { i18nTypes as types, getLang, setLang, getJSON } from './utils'\n\nwindow.addEventListener('load', () => {\n  let getFormat = document.querySelector('head meta[i18n]')\n\n  if(getFormat) {\n    getFormat = getFormat.getAttribute('i18n')\n    // (Get & Set) language\n    let _getLang = getLang()\n    let langBtns = document.querySelectorAll('[i18n-lang-btn]')\n    if(!_getLang) {\n      let currLang = document.querySelector('[i18n-def]') || langBtns[0]\n      currLang.classList.add('i18n-active')\n      if(currLang) _getLang = currLang.getAttribute('i18n-lang-btn')\n      setLang(_getLang)\n    } else {\n      langBtns.forEach(i => {\n        if(i.getAttribute('i18n-lang-btn') === getLang()) {\n          i.classList.add('i18n-active')\n        }\n      })\n    }\n    \n    const rules = () => {\n      let path = getFormat.replace('{lang}', getLang())\n      let basePath = path.match(/(.*i18n\\/)(.*)/)[1]\n      types.forEach(i => {\n        let _attr = `i18n-${i}`\n        let _el = document.querySelectorAll(`[${_attr}]`)\n        if(_el.length > 0) {\n          switch (true) {\n            case /^c((-ph)?|(-i)?)$/.test(i): // common\n              getJSON(`${basePath}/pub/common.${getLang()}.json`, 'c', _el, _attr, i)\n              break\n            case /^k(-ph)?$/.test(i): // keyword\n              getJSON(`${basePath}/pub/keywords.${getLang()}.json`, 'k', _el, _attr, i)\n              break\n            case /^p((-ph)?|(-i)?)$/.test(i): // current page\n              getJSON(`${path}.json`, 'p', _el, _attr, i)\n              break\n            case /^s$/.test(i): // i18n class\n              document.querySelectorAll('[i18n-s]').forEach(i => {\n                let notI18nCls = Array.from(i.classList).filter(j => !/i18n-*/.test(j)).join(' ')\n                i.classList = notI18nCls\n                i.classList.add(`i18n-${getLang()}`)\n              })\n              break\n            default:\n              break\n          }\n        }\n      })\n    }\n    rules()\n    langBtns.forEach(btn => {\n      btn.addEventListener('click', () => {\n        if(getLang() !== btn.getAttribute('i18n-lang-btn')) {\n          langBtns.forEach(i => {\n            i.classList.remove('i18n-active')\n          })\n          btn.classList.add('i18n-active')\n          setLang(btn.getAttribute('i18n-lang-btn'))\n          rules()\n        }\n      })\n    })\n  }\n})\n"],"names":["i18nTypes","setLang","lang","window","localStorage","setItem","getLang","getItem","getJSON","uri","type","_el","_attr","i","forEach","j","getAttribute","cb","httpRequest","XMLHttpRequest","ActiveXObject","alert","onreadystatechange","readyState","DONE","status","responseText","console","error","open","send","getData","data","JSON","parse","val","innerHTML","src","placeholder","addEventListener","getFormat","document","querySelector","_getLang","langBtns","querySelectorAll","classList","add","currLang","rules","path","replace","basePath","match","types","length","test","notI18nCls","Array","from","filter","join","btn","remove"],"mappings":"6JAEMA,EAAY,CAAC,IAAK,IAAK,IAAK,IAAK,OAAQ,OAAQ,OAAQ,MAAO,MAAO,OAEvEC,EAAUC,GAAQC,OAAOC,aAAaC,QAAQ,gBAAiBH,GAC/DI,EAAU,IAAMH,OAAOC,aAAaG,QAAQ,iBAE5CC,EAAU,CAACC,EAAKC,EAAMC,EAAKC,EAAOC,KACtCF,EAAIG,QAAQC,IACsB,OAA7BA,EAAEC,aAAa,WCJP,SAAUP,EAAKQ,OACxBC,KACAf,OAAOgB,eAETD,EAAc,IAAIC,eACThB,OAAOiB,gBAEhBF,EAAc,IAAIE,cAAc,uBAG7BF,SACHG,MAAM,mDACC,EAETH,EAAYI,8BAKPJ,EAAYK,aAAeJ,eAAeK,OACjB,MAAvBN,EAAYO,OACbR,EAAGC,EAAYQ,cAEfC,QAAQC,MAAM,2CARpBV,EAAYW,KAAK,MAAOpB,GACxBS,EAAYY,KAAK,MDXbC,CAAQtB,EAAKuB,IACXA,EAAOC,KAAKC,MAAMF,OACdG,EAAMpB,EAAEC,aAAaJ,GACtBC,IAAMH,IAAMK,EAAEqB,UAAYJ,EAAKG,IAC/BtB,OAASH,QAAUK,EAAEsB,IAAML,EAAKG,IAChCtB,OAASH,SAAWK,EAAEuB,YAAcN,EAAKG,SEbpDhC,OAAOoC,iBAAiB,OAAQ,SAC1BC,EAAYC,SAASC,cAAc,sBAEpCF,EAAW,CACZA,EAAYA,EAAUxB,aAAa,YAE/B2B,EAAWrC,IACXsC,EAAWH,SAASI,iBAAiB,sBACrCF,EAMFC,EAAS9B,QAAQD,IACZA,EAAEG,aAAa,mBAAqBV,KACrCO,EAAEiC,UAAUC,IAAI,qBARR,KACRC,EAAWP,SAASC,cAAc,eAAiBE,EAAS,GAChEI,EAASF,UAAUC,IAAI,eACpBC,IAAUL,EAAWK,EAAShC,aAAa,kBAC9Cf,EAAQ0C,SASJM,EAAQ,SACRC,EAAOV,EAAUW,QAAQ,SAAU7C,KACnC8C,EAAWF,EAAKG,MAAM,kBAAkB,GAC5CC,EAAMxC,QAAQD,QACRD,UAAgBC,IAChBF,EAAM8B,SAASI,qBAAqBjC,SACrCD,EAAI4C,OAAS,UACN,OACD,oBAAoBC,KAAK3C,GAC5BL,KAAW4C,gBAAuB9C,WAAkB,IAAKK,EAAKC,EAAOC,aAElE,YAAY2C,KAAK3C,GACpBL,KAAW4C,kBAAyB9C,WAAkB,IAAKK,EAAKC,EAAOC,aAEpE,oBAAoB2C,KAAK3C,GAC5BL,KAAW0C,SAAa,IAAKvC,EAAKC,EAAOC,aAEtC,MAAM2C,KAAK3C,GACd4B,SAASI,iBAAiB,YAAY/B,QAAQD,QACxC4C,EAAaC,MAAMC,KAAK9C,EAAEiC,WAAWc,OAAO7C,IAAM,SAASyC,KAAKzC,IAAI8C,KAAK,KAC7EhD,EAAEiC,UAAYW,EACd5C,EAAEiC,UAAUC,YAAYzC,aASpC2C,IACAL,EAAS9B,QAAQgD,IACfA,EAAIvB,iBAAiB,QAAS,KACzBjC,MAAcwD,EAAI9C,aAAa,mBAChC4B,EAAS9B,QAAQD,IACfA,EAAEiC,UAAUiB,OAAO,iBAErBD,EAAIhB,UAAUC,IAAI,eAClB9C,EAAQ6D,EAAI9C,aAAa,kBACzBiC"}